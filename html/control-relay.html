<!DOCTYPE html>
<html>
<head>
  <title>Control Page</title>
</head>
<body>
  <center>
    <h1>Control The Circuits</h1>
    <button id="relayOn" onclick="turnRelayOn()">Turn Relay ON</button>
    <button id="relayOff" onclick="turnRelayOff()">Turn Relay OFF</button>
  </center>

  <script>
    function turnRelayOn() {
      // Send a request to the ESP32 server to turn the relay ON
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          // Optionally, you can handle the response from the server here
          console.log("Relay turned ON");
          // Call the myAPI function after the relay is turned ON
          myAPI();
        }
      };
      xhttp.open("GET", "http://192.168.172.6/1/on", true); // Adjusted URL to turn the relay ON
      xhttp.send();
    }

    function turnRelayOff() {
      // Send a request to the ESP32 server to turn the relay OFF
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          // Optionally, you can handle the response from the server here
          console.log("Relay turned OFF");
          // Call the myAPI function after the relay is turned OFF
          myAPI();
        }
      };
      xhttp.open("GET", "http://192.168.172.6/1/off", true); // Adjusted URL to turn the relay OFF
      xhttp.send();
    }

    function myAPI() {
      fetch("http://192.168.172.6/1/status") // Use the same IP address as the ESP32 server
        .then(res => res.json())
        .then(data => {
          console.log(data);
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }
  </script>
</body>
</html>
